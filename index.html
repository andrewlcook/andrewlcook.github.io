<!DOCTYPE html>
<html>
  <head>
    <!-- EXTERNAL LIBS-->
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.1/jquery.min.js"></script>
    <script src="https://www.google.com/jsapi"></script>

	
    
    <!-- EXAMPLE SCRIPT -->
    <script>
	   google.load('visualization', '1.0', {'packages':['controls']});
       google.setOnLoadCallback(drawDashboard);
      // onload callback
      function drawDashboard() {

        var public_key = 'YG5mJ5Qg8rIzXl1mYDaq';

        // JSONP request
        var jsonData = $.ajax({
          url: 'https://data.sparkfun.com/output/' + public_key + '.json',
          data: 'gt[timestamp]=now%20-2day',
          dataType: 'jsonp',
        }).done(function (results) {

          var bluedata = new google.visualization.DataTable();
         
          
		  bluedata.addColumn('datetime', 'Time');
          bluedata.addColumn('number', 'Total Energy (kWh)');
          bluedata.addColumn('number', 'Temperature (degreesC)');
		  bluedata.addColumn('number', 'Power Usage (Watts)');
		  
          $.each(results, function (i, row) {
            bluedata.addRow([
              (new Date(row.timestamp)),
              parseFloat(row.power),
			  parseFloat(row.temp),
			  parseFloat(row.totpower),
            ]);
		});
		

        var dashboard = new google.visualization.Dashboard(document.getElementById('dashboard_div'));


         // Create a range slider, passing some options
		var dateRangeSlider = new google.visualization.ControlWrapper({
			'controlType': 'ChartRangeFilter',
			'containerId': 'daterangepicker',
			'options': {
			'filterColumnLabel': 'Time',
				'ui': {
				'chartType': 'LineChart',
				'chartOptions': {
					'enableInteractivity': false,
					'chartArea': {'height': '20%'},
					'legend': {'position': 'none'},
					'hAxis': {'textPosition': 'in'},
					'vAxis': {
						'textPosition': 'none',
						'gridlines': {'color': 'none'}
					}
				},
				'chartView': {'columns': [0, 3]}
				}
			}
		});

		var powChart = new google.visualization.ChartWrapper({
			'chartType': 'LineChart',
			'containerId': 'chart1',
			'options': {
			'title': 'Realtime Power Usage',
			'series': [{'color': 'orange'}]
		},
		// out of all the available ones.
			'view': {'columns': [0, 3]},
			
			
		});
		
		var tempChart = new google.visualization.ChartWrapper({
			'chartType': 'LineChart',
			'containerId': 'chart3',
			'options': {
			'title': 'Temperature',
			'series': {
				0: {'color': 'indigo'}
			}
			},
		// out of all the available ones.
			'view': {'columns': [0, 2]},
			
		});
		var totpowChart = new google.visualization.ChartWrapper({
			'chartType': 'LineChart',
			'containerId': 'chart2',
			'options': {
			'title': 'Total Energy Usage (kWh)',
			'series': {
				0: {'color': 'green'}
			}
		},
		// out of all the available ones.
			'view': {'columns': [0, 1]},
			
		});
		
		 dashboard.bind(dateRangeSlider, [powChart, tempChart, totpowChart]);
		
		dashboard.draw(bluedata);
      
	});
	}
    </script>
		
	
  </head>
  <body>
    <div id="dashboard_div" style="width: 100%;">
	<div id="chart1" style="width: 100%;"></div>
	<div id="chart2" style="width: 100%;"></div>
	<div id="chart3" style="width: 100%;"></div>
	<div id="daterangepicker" style="width: 100%;"></div>
	</div>
  </body>
</html>
